name: Validar OpenAPI dos TJs Estaduais

on:
  workflow_dispatch:

jobs:
  validar-openapi:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout do repositório
        uses: actions/checkout@v4

      - name: Validar OpenAPI (IBM OpenAPI Validator via Docker)
        run: |
          set -euo pipefail
          SPEC="schemas/openapi_tjs.yaml"
          if [ ! -f "$SPEC" ]; then
            echo "❌ Arquivo OpenAPI não encontrado: $SPEC"
            exit 1
          fi
          echo "✅ Validando: $SPEC"
          docker run --rm \
            -v "$PWD:/data:ro" \
            -w /data \
            ibmdevxsdk/openapi-validator:1.37.9 \
              "$SPEC"
